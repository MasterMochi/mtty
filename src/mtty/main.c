/******************************************************************************/
/*                                                                            */
/* src/mtty/main.c                                                            */
/*                                                                 2020/08/11 */
/* Copyright (C) 2018-2020 Mochi.                                             */
/*                                                                            */
/******************************************************************************/
/******************************************************************************/
/* インクルード                                                               */
/******************************************************************************/
/* 標準ヘッダ */
#include <stddef.h>

/* ライブラリヘッダ */
#include <libmk.h>

/* モジュール内ヘッダ */
#include "Bufmng.h"
#include "Debug.h"
#include "Devt.h"
#include "Sessmng.h"
#include "Tctrl.h"
#include "Uevt.h"


/******************************************************************************/
/* ローカル関数宣言                                                           */
/******************************************************************************/
/* 初期化 */
static void Init( void );


/******************************************************************************/
/* グローバル関数定義                                                         */
/******************************************************************************/
/******************************************************************************/
/**
 * @brief       mvfsエントリ関数
 * @details     各モジュールの初期化機能を呼び出し、制御を開始する。
 */
/******************************************************************************/
void main( void )
{
    /* TODO: mvfs, drv起動待ち合わせ */
    LibMkTimerSleep( 5000000, NULL );

    DEBUG_LOG_TRC( "start!" );

    /* 初期化 */
    Init();

    /* 制御開始 */
    DevtStart();

    return;
}


/******************************************************************************/
/* ローカル関数定義                                                           */
/******************************************************************************/
/******************************************************************************/
/**
 * @brief       初期化
 * @details     各モジュールの初期化を行う。
 */
/******************************************************************************/
static void Init( void )
{
    /* バッファ管理初期化 */
    BufmngInit();

    /* デバイスイベント初期化 */
    DevtInit();

    /* ターミナル制御初期化 */
    TctrlInit();

    /* セッション管理初期化 */
    SessmngInit();

    /* ユーザイベント初期化 */
    UevtInit();

    return;
}


/******************************************************************************/
