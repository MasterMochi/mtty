/******************************************************************************/
/* src/Sess.c                                                                 */
/*                                                                 2018/10/10 */
/* Copyright (C) 2018 Mochi.                                                  */
/******************************************************************************/
/******************************************************************************/
/* インクルード                                                               */
/******************************************************************************/
/* 共通ヘッダ */
#include "mtty.h"
#include <mterm.h>
#include <stdbool.h>
#include <stddef.h>
#include <kernel/library.h>

/* モジュールヘッダ */
#include "Ldisc.h"


/******************************************************************************/
/* ローカル関数宣言                                                           */
/******************************************************************************/


/******************************************************************************/
/* グローバル変数宣言                                                         */
/******************************************************************************/


/******************************************************************************/
/* グローバル関数定義                                                         */
/******************************************************************************/
/******************************************************************************/
/**
 * @brief       端末データ入力
 * @detail      端末からのデータを入力する。
 * 
 * @param[in]   *pMsg メッセージ
 */
/******************************************************************************/
void SessInput( MttyMsgInput_t *pMsg )
{
    /* ラインディシプリン入力 */
    LdiscInput( pMsg->data, pMsg->header.length );
    
    return;
}


/******************************************************************************/
/**
 * @brief       端末データ読込実行
 * @detail      端末から入力したデータの読込要求を処理する。
 * 
 * @param[in]   *pMsg メッセージ
 */
/******************************************************************************/
void SessDoRead( MttyMsgRead_t *pMsg )
{
    /* ラインディシプリンread実行 */
    LdiscDoRead();
    
    return;
}


/******************************************************************************/
/**
 * @brief       端末データ書込実行
 * @detail      端末へのデータ出力要求を処理する。
 * 
 * @param[in]   *pMsg メッセージ
 */
/******************************************************************************/
void SessDoWrite( MttyMsgWrite_t *pMsg )
{
    MtermMsgOutput_t *pOutput;
    
    pOutput                = ( MtermMsgOutput_t * ) pMsg;
    pOutput->header.funcId = MTERM_FUNC_OUTPUT;
    
    /* 端末データ書込 */
    MkMsgSend( 3, pMsg, sizeof ( MtermMsgHdr_t ) + pMsg->header.length, NULL );
    
    return;
}



/******************************************************************************/
