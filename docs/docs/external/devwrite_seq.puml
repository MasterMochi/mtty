@startuml

participant drv as "drv-ns16550"
participant mtty
participant user

activate mtty

loop
    mtty -> mtty: LibmvfsSelect()
    deactivate mtty

    activate drv
    rnote over drv #FFFFFF: 書き込み可能
    drv ->> mtty: VfsReady
    deactivate drv
    activate mtty

    mtty -> mtty: 書込バッファからデータ取り出し

    opt データ有
        drv <<- mtty: LibmvfsWrite()
        activate drv
        drv -->> mtty:
        deactivate drv
    end
end
deactivate mtty

@enduml
