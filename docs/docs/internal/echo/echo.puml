@startuml

participant "drv-ns16550" as drv

box "mtty"
    participant "デバイス制御" as dctrl
    participant "エコー"       as echo
end box

activate dctrl

ref over dctrl: デバイスファイル読込み

dctrl -> echo: EchoDo( fd, データサイズ, ... )
activate echo

loop データサイズ分
    opt 制御コード
        rnote over echo #FFFFFF: 文字変換
    end opt

    drv <<- echo: LibMvfsWrite( fd, ...)
    activate drv
    drv -->> echo:
    deactivate drv
end loop

dctrl <-- echo:
deactivate echo
||20||

@enduml

